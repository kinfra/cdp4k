Обработка ошибок:
 * закрытие пользовательского scope при обрыве соединения, чтобы не ждать события бесконечно
 * закрытие соединения при ошибках обработки входящих сообщений или отправки
